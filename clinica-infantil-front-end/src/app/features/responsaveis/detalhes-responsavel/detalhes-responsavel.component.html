<div class="dashboard container my-5">
  @if (isLoading) {
    <div class="alert alert-info mt-3">Carregando detalhes do responsável...</div>
  }

  @if (error) {
    <div class="alert alert-danger mt-3">{{ error }}</div>
  }

  @if (!isLoading && responsavel) {
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2>Detalhes do Responsável: {{ responsavel.cliente.nome }}</h2>
      <a class="btn btn-secondary" [routerLink]="['/administrador/responsaveis']">Voltar para a Lista</a>
    </div>

    <!-- Informações do Responsável -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-secondary text-white">
        Dados do Responsável
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <strong>Nome:</strong> {{ responsavel.cliente.nome || 'N/A' }}<br>
            <strong>CPF:</strong> {{ responsavel.cliente.cpf || 'N/A' }}<br>
            <strong>RG:</strong> {{ responsavel.cliente.rg || 'N/A' }}<br>
            <strong>Grau de Parentesco:</strong> {{ responsavel.grau_parentesco || 'N/A' }}
          </div>
          <div class="col-md-6">
            <strong>Email:</strong> {{ responsavel.email || 'N/A' }}<br>
            <strong>Telefone:</strong> {{ responsavel.telefone || 'N/A' }}<br>
            <strong>Endereço:</strong> {{ responsavel.cliente.endereco || 'N/A' }}<br>
            <strong>Cidade:</strong> {{ responsavel.cliente.cidade.nome_cidade || 'N/A' }}<br>
            <strong>Estado:</strong> {{ responsavel.cliente.cidade.estado.nome_estado }}
          </div>
        </div>
      </div>
    </div>
    
    <!-- Pacientes Associados -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-primary text-white">
        Pacientes Associados
      </div>
      <div class="card-body">
        @if (responsavel.pacientes && responsavel.pacientes.length > 0) {
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nome do Paciente</th>
                  <th>Data de Nascimento</th>
                  <th>Histórico Médico</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                @for (paciente of responsavel.pacientes; track paciente.id) {
                  <tr>
                    <td>{{ paciente.id }}</td>
                    <td>{{ paciente.cliente.nome || 'N/A' }}</td>
                    <td>{{ paciente.data_nascimento | date: 'dd/MM/yyyy' }}</td>
                    <td>{{ paciente.historico_medico || 'N/A' }}</td>
                    <td>
                      <a [routerLink]="['/administrador/pacientes', paciente.id]" class="btn btn-sm btn-outline-primary">Ver Detalhes</a>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        } @else {
          <div class="alert alert-warning">Nenhum paciente associado a este responsável.</div>
        }
      </div>
    </div>
  }

  @if (!isLoading && !responsavel) {
    <div class="alert alert-warning mt-3">Responsável não encontrado.</div>
  }
</div>